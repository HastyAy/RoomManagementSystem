@page "/"
@page "/dashboard"
@using RoomManagement.Frontend.Services
@inject BookingService BookingService
@inject RoomService RoomService
@inject NavigationManager Navigation

<PageTitle>Dashboard - Room Management</PageTitle>

<div class="dashboard-container">
    <!-- Header -->
    <div class="header-card">
        <div class="header-icon">
            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                <circle cx="12" cy="10" r="3"></circle>
            </svg>
        </div>
        <div>
            <h1 class="header-title">Room Management Dashboard</h1>
            <p class="header-subtitle">Welcome back! Here's what's happening today.</p>
        </div>
    </div>

    <!-- Stats Grid -->
    <div class="stats-grid">
        <!-- Total Rooms Card -->
        <div class="stat-card stat-card-blue">
            <div class="stat-header">
                <div class="stat-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                        <circle cx="12" cy="10" r="3"></circle>
                    </svg>
                </div>
                <div class="stat-trend">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline>
                        <polyline points="17 6 23 6 23 12"></polyline>
                    </svg>
                    +2 this month
                </div>
            </div>
            <h3 class="stat-title">Total Rooms</h3>
            <p class="stat-value">@(loading ? "..." : totalRooms.ToString())</p>
        </div>

        <!-- Active Bookings Card -->
        <div class="stat-card stat-card-emerald">
            <div class="stat-header">
                <div class="stat-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                    </svg>
                </div>
                <div class="stat-trend">Live now</div>
            </div>
            <h3 class="stat-title">Active Bookings</h3>
            <p class="stat-value">@(loading ? "..." : activeBookings.ToString())</p>
            <p class="stat-subtitle">Currently in use</p>
        </div>

        <!-- Available Rooms Card -->
        <div class="stat-card stat-card-purple">
            <div class="stat-header">
                <div class="stat-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                        <polyline points="22 4 12 14.01 9 11.01"></polyline>
                    </svg>
                </div>
                <div class="stat-trend">@utilizationRate% free</div>
            </div>
            <h3 class="stat-title">Available Rooms</h3>
            <p class="stat-value">@(loading ? "..." : availableRooms.ToString())</p>
        </div>

        <!-- Today's Bookings Card -->
        <div class="stat-card stat-card-orange">
            <div class="stat-header">
                <div class="stat-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                        <line x1="16" y1="2" x2="16" y2="6"></line>
                        <line x1="8" y1="2" x2="8" y2="6"></line>
                        <line x1="3" y1="10" x2="21" y2="10"></line>
                    </svg>
                </div>
                <div class="stat-trend">+20% vs yesterday</div>
            </div>
            <h3 class="stat-title">Today's Bookings</h3>
            <p class="stat-value">@(loading ? "..." : todayBookings.ToString())</p>
        </div>
    </div>

    <!-- Main Content Grid -->
    <div class="main-grid">
        <!-- Utilization Chart -->
        <div class="chart-card">
            <div class="card-header">
                <h2 class="card-title">Room Utilization</h2>
                <div style="display: flex; gap: 0.5rem;">
                    <button class="tab-button active">Today</button>
                    <button class="tab-button">Week</button>
                    <button class="tab-button">Month</button>
                </div>
            </div>

            <!-- Utilization Bar -->
            <div class="utilization-bar">
                <div class="utilization-header">
                    <span style="font-size: 0.875rem; font-weight: 500; color: #374151;">Current Utilization</span>
                    <span style="font-size: 0.875rem; font-weight: 900; color: #2563eb;">@utilizationRate%</span>
                </div>
                <div class="utilization-progress">
                    <div class="utilization-fill" style="width: @(utilizationRate)%"></div>
                </div>
            </div>

            <!-- Room Status Grid -->
            <div class="room-grid">
                @if (loading)
                {
                    @for (int i = 0; i < 4; i++)
                    {
                        <div class="room-card loading-pulse">
                            <div style="height: 1rem; background: #e5e7eb; border-radius: 0.25rem; margin-bottom: 0.5rem;"></div>
                            <div style="height: 0.75rem; background: #e5e7eb; border-radius: 9999px; width: 4rem;"></div>
                        </div>
                    }
                }
                else
                {
                    @foreach (var room in sampleRooms)
                    {
                        <div class="room-card">
                            <h4 class="room-name">@room.Name</h4>
                            <span class="room-status @GetStatusClass(room.Status)">@room.Status</span>
                        </div>
                    }
                }
            </div>
        </div>

    </div>

    <!-- Quick Actions -->
    <div class="quick-actions">
        <button class="action-card action-blue" @onclick="NavigateToBookings">
            <div class="action-content">
                <h3>Book a Room</h3>
                <p>Reserve a space quickly</p>
            </div>
            <svg class="action-icon" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                <line x1="16" y1="2" x2="16" y2="6"></line>
                <line x1="8" y1="2" x2="8" y2="6"></line>
                <line x1="3" y1="10" x2="21" y2="10"></line>
            </svg>
        </button>

        <button class="action-card action-emerald" @onclick="NavigateToRooms">
            <div class="action-content">
                <h3>Manage Rooms</h3>
                <p>Edit room details</p>
            </div>
            <svg class="action-icon" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                <circle cx="12" cy="10" r="3"></circle>
            </svg>
        </button>

        <button class="action-card action-purple" @onclick="NavigateToPeople">
            <div class="action-content">
                <h3>Manage People</h3>
                <p>Students & Professors</p>
            </div>
            <svg class="action-icon" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                <circle cx="9" cy="7" r="4"></circle>
                <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
            </svg>
        </button>
    </div>
</div>


